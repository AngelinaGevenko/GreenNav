<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../google-map/google-map.html">
<link rel="import" href="../google-map/google-map-poly.html">
<link rel="import" href="../google-map/google-map-point.html">
<link rel="import" href="../osm-map/osm-map.html">
<link rel="import" href="../osm-map/osm-poly.html">
<link rel="import" href="../osm-map/osm-point.html">
<!--
    
The `gn-map` element provides a wrapper for different map types.
If attribute map-type change, the changes will apply to all child elements.
At this time `gn-map` supports `google-map` and `osm-map` and all
children like polygons, points and markers.

@demo
-->

<dom-module id="gn-map">
  <template>
    <style>
      :host {
        display: block;
        width: 100%;
        height: 100%;
      }
    </style>

    <template is="dom-if" if="{{ _typeIsOpenStreetMap(mapType) }}">
      <osm-map longitude="{{ longitude }}" latitude="{{ latitude }}" zoom="{{ zoom }}">
        <template is="dom-repeat" items="{{ polygons }}">
          <osm-poly stroke-color$="{{ item.strokeColor }}" width$="{{ item.width}}" fill$="{{ item.fill }}" fill-color$="{{ item.fillColor }}">
            <template is="dom-repeat" items="{{ item.points }}">
              <osm-point longitude$="{{ item.longitude }}" latitude$="{{ item.latitude }}"></osm-point>
            </template>
          </osm-poly>
        </template>
      </osm-map>
    </template>

    <template is="dom-if" if="{{ _typeIsGoogleMap(mapType) }}">
      <google-map longitude="{{ longitude }}" latitude="{{ latitude }}" zoom="{{ zoom }}">
        <template is="dom-repeat" items="{{ polygons }}">
          <google-map-poly stroke-color$="{{ item.strokeColor }}" width$="{{ item.width}}" fill$="{{ item.fill }}" fill-color$="{{ item.fillColor }}">
            <template is="dom-repeat" items="{{ item.points }}">
              <google-map-point longitude$="{{ item.longitude }}" latitude$="{{ item.latitude }}"></google-map-point>
            </template>
          </google-map-poly>
        </template>  
      </google-map>
    </template>

  </template>
<script>
  Polymer({
    is: 'gn-map',

    properties: {
      /**
       * A latitude to center the map on.
       */
      latitude: {
        type: Number,
        notify: true,
        value: 53.834089,
        reflectToAttribute: true
      },

      /**
       * A longitude to center the map on.
       */
      longitude: {
        type: Number,
        notify: true,
        value: 10.703718,
        reflectToAttribute: true
      },

      /**
       * A zoom level which will be applied to the map.
       */
      zoom: {
        type: Number,
        value: 11,
        notify: true,
        reflectToAttribute: true
      },

      /**
       * The map-type is bind by dom-if template to include different type of maps
       * Possible values are "GoogleMap" or "OpenStreetMap".
       */
      mapType: {
        type: String,
        value:"GoogleMap",
        notify: true
      },

      /**
       * Holds the map object and allows to modify values during runtime
       */
      map: {
        type: Object
      },

      polygons: {
          type: Array,
          value: null
      }
    },

    ready: function() {
      this.polygons = this.queryAllEffectiveChildren('gn-poly');
    },

    _typeIsOpenStreetMap: function(mapType) {
        return mapType === 'OpenStreetMap';
    },

    _typeIsGoogleMap: function(mapType) {      
        return mapType === 'GoogleMap';
    }
  });
</script>

</dom-module>